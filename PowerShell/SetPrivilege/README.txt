This isn't my script, but I can't remember where I found it.
Credit to original owner.